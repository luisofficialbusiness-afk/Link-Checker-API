<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>link</title>
<style>
body{font-family:monospace;max-width:800px;margin:40px auto;padding:0 20px;background:#1a1a1a;color:#ccc}
input,select,button{font-family:monospace;padding:6px 10px;font-size:14px;background:#2a2a2a;color:#ccc;border:1px solid #444}
input[type=text]{width:300px}
button{cursor:pointer}
button:hover{background:#333}
table{width:100%;border-collapse:collapse;margin-top:20px}
th,td{border:1px solid #444;padding:8px;text-align:left}
th{background:#252525}
.blocked{color:#ff4444;font-weight:bold}
.unblocked{color:#44ff44;font-weight:bold}
.error{color:#ffaa00;font-weight:bold}
.unknown{color:#888;font-weight:bold}
.ms{color:#888;font-size:12px}
#status{margin-top:15px;padding:10px;border:1px solid #444;display:none}
#stats{margin-top:20px;font-size:13px}
hr{border:none;border-top:1px solid #333;margin:30px 0}
</style>
</head>
<body>
<h2>TGLSC LTSLink</h2>
<div>
<label>URL to check:</label><br>
<input type="text" id="url" placeholder="e.g. google.com">
</div>
<br>
<div>
<label>Filter:</label><br>
<select id="filter">
<option value="">All Filters</option>
<option value="fortiguard">ğŸ›¡ï¸ FortiGuard</option>
<option value="lightspeed">ğŸš¦ Lightspeed</option>
<option value="paloalto">ğŸªµ Palo Alto</option>
<option value="blocksiweb">ğŸ§± Blocksi Web</option>
<option value="blocksiai">ğŸ¤– Blocksi AI</option>
<option value="linewize">ğŸ‹â€ğŸŸ© Linewize</option>
<option value="cisco">â˜‚ï¸ Cisco Umbrella</option>
<option value="securly">âš›ï¸ Securly</option>
<option value="goguardian">ğŸ”’ GoGuardian</option>
<option value="lanschool">ğŸ« LanSchool</option>
<option value="contentkeeper">ğŸ§¹ ContentKeeper</option>
<option value="aristotle">ğŸ¥ AristotleK12</option>
<option value="senso">ğŸŒ³ Senso Cloud</option>
<option value="deledao">ğŸ˜ˆ Deledao</option>
<option value="iboss">ğŸ’¼ iBoss</option>
</select>
</div>
<br>
<button onclick="checkURL()">scan link</button>
<button onclick="getStats()">website stats</button>
<div id="status"></div>
<div id="results"></div>
<div id="stats"></div>

<script>
var LTS_API = "https://live.glseries.net";
var LTS_TOKEN = "gl_b047d85808c2b4cabc56e751d938c054545ee7eea0cdff65";

var FILTERS = {
    fortiguard: "ğŸ›¡ï¸ FortiGuard",
    lightspeed: "ğŸš¦ Lightspeed",
    paloalto: "ğŸªµ Palo Alto",
    blocksiweb: "ğŸ§± Blocksi Web",
    blocksiai: "ğŸ¤– Blocksi AI",
    linewize: "ğŸ‹â€ğŸŸ© Linewize",
    cisco: "â˜‚ï¸ Cisco Umbrella",
    securly: "âš›ï¸ Securly",
    goguardian: "ğŸ”’ GoGuardian",
    lanschool: "ğŸ« LanSchool",
    contentkeeper: "ğŸ§¹ ContentKeeper",
    aristotle: "ğŸ¥ AristotleK12",
    senso: "ğŸŒ³ Senso Cloud",
    deledao: "ğŸ˜ˆ Deledao",
    iboss: "ğŸ’¼ iBoss"
};

function showStatus(msg, type) {
    var s = document.getElementById("status");
    s.style.display = "block";
    s.textContent = msg;
    s.style.borderColor = type === "error" ? "#ff4444" : type === "ok" ? "#44ff44" : "#444";
}

function parseStatus(entry) {
    if (!entry || typeof entry !== "object") return { label: "UNKNOWN", cssClass: "unknown" };
    if (entry.error) return { label: "ERROR", cssClass: "error" };
    if (entry.blocked === true) return { label: "LIKELY BLOCKED", cssClass: "blocked" };
    if (entry.blocked === false) return { label: "LIKELY UNBLOCKED", cssClass: "unblocked" };
    return { label: "UNKNOWN", cssClass: "unknown" };
}

function checkURL() {
    var url = document.getElementById("url").value.trim();
    var filter = document.getElementById("filter").value;
    var resultsDiv = document.getElementById("results");
    resultsDiv.innerHTML = "";

    if (!url) { showStatus("Please enter a URL to check.", "error"); return; }

    var endpoint = LTS_API + "/api/v1/check?token=" + encodeURIComponent(LTS_TOKEN) + "&url=" + encodeURIComponent(url);
    if (filter) endpoint += "&filter=" + encodeURIComponent(filter);

    showStatus("Checking...", "info");

    var startTime = performance.now();

    fetch(endpoint)
        .then(function(r) { return r.json(); })
        .then(function(data) {
            var totalMs = Math.round(performance.now() - startTime);

            if (data.error) {
                showStatus("Error: " + (data.error || data.code || "Unknown"), "error");
                resultsDiv.innerHTML = "<p class='error'>" + (data.code || "") + " - " + (data.error || data.message || "Unknown error") + "</p>";
                return;
            }

            showStatus("Check complete in " + totalMs + "ms", "ok");

            var results = data.results || data;
            var html = "<table><tr><th>Filter</th><th>Name</th><th>Category</th><th>Status</th><th>Time</th></tr>";

            if (typeof results === "object" && !Array.isArray(results)) {
                var keys = Object.keys(results);
                if (keys.length === 0) {
                    html += "<tr><td colspan='5'>No results returned.</td></tr>";
                }
                keys.forEach(function(k) {
                    var entry = results[k];
                    var s = parseStatus(entry);
                    var category = "-";
                    var ms = "-";
                    if (typeof entry === "object") {
                        category = entry.category || entry.categories || "-";
                        if (typeof category === "object") category = JSON.stringify(category);
                        if (entry.ms !== undefined) ms = entry.ms + " ms";
                        else if (entry.time !== undefined) ms = entry.time + " ms";
                        else if (entry.duration !== undefined) ms = entry.duration + " ms";
                    }
                    var name = FILTERS[k] || k;
                    html += "<tr><td>" + k + "</td><td>" + name + "</td><td>" + category + "</td><td class='" + s.cssClass + "'>" + s.label + "</td><td class='ms'>" + ms + "</td></tr>";
                });
            } else if (Array.isArray(results)) {
                results.forEach(function(entry) {
                    var key = entry.filter || entry.key || "-";
                    var s = parseStatus(entry);
                    var category = entry.category || entry.categories || "-";
                    if (typeof category === "object") category = JSON.stringify(category);
                    var ms = "-";
                    if (entry.ms !== undefined) ms = entry.ms + " ms";
                    else if (entry.time !== undefined) ms = entry.time + " ms";
                    else if (entry.duration !== undefined) ms = entry.duration + " ms";
                    var name = FILTERS[key] || key;
                    html += "<tr><td>" + key + "</td><td>" + name + "</td><td>" + category + "</td><td class='" + s.cssClass + "'>" + s.label + "</td><td class='ms'>" + ms + "</td></tr>";
                });
            } else {
                html += "<tr><td colspan='5'>" + JSON.stringify(data) + "</td></tr>";
            }

            html += "</table>";
            resultsDiv.innerHTML = html;
        })
        .catch(function(e) { showStatus("Request failed: " + e.message, "error"); });
}

function getStats() {
    fetch(LTS_API + "/api/stats")
        .then(function(r) { return r.json(); })
        .then(function(data) {
            var statsDiv = document.getElementById("stats");
            var total = data.total || data.checks || data.count || JSON.stringify(data);
            statsDiv.innerHTML = "<hr><b>Platform Stats:</b> " + total + " total checks performed.";
        })
        .catch(function(e) { showStatus("Failed to load stats: " + e.message, "error"); });
}
</script>
</body>
</html>
